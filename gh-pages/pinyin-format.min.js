!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self)["pinyin-format"]={})}(this,function(t){"use strict";var e;(e=t.PinyinStyle||(t.PinyinStyle={})).TONE="tone",e.TONE2="tone2",e.TO3NE="to3ne";const o=["̄","́","̌","̀"],l=["b","p","m","f","d","t","n","l","g","k","h","j","q","x","zh","ch","sh","r","z","c","s","y","w"],u=["a","o","e","i","u","ü","er","ai","uai","ei","ao","iao","ou","ia","ie","ua","uo","üe","ui","iu","ue","an","ian","uan","üan","en","in","un","ün","ang","iang","uang","eng","ueng","ing","ong","iong"],f=["ng","m","n"],c=e=>{let n="",i=0;for(i=0;i<e.length;i+=1){var r=e[i];if(!l.includes(r))break;n+=r}var a=e.slice(i);return u.includes(a)?{initial:n,final:a}:null},s=n=>{var e=n.match(/[a-zü](\d)/i);if(e)return+e[1];for(let e=0;e<o.length;e+=1)if(n.normalize("NFD").match(o[e]))return e+1;return 5},y=e=>(e=e.normalize("NFD").replace(/\u0304|\u0301|\u030c|\u0300/,"")).normalize("NFC").replace(/[1-5]/,""),i=(n,i)=>{var e=n;if(!(n=n.trim()).length)return e;n=n.toLocaleLowerCase();var r=s(n),a=(n=(n=y(n)).replace("v","ü"),c(n));if(!a&&!f.includes(n))return console.error("The pinyin input is not grammatical"),e;if(i===t.PinyinStyle.TONE2)return n+r;{let e=n.search(/[aeo]/);return-1===(e=-1===e?Math.max(n.lastIndexOf("i"),n.lastIndexOf("u"),n.lastIndexOf("ü")):e)&&(e=0),i===t.PinyinStyle.TONE?5===r?n:n.replace(n[e],n[e]+o[r-1]).normalize("NFC"):n.replace(n[e],n[e]+r)}};t.pinyinFormat=(e,n=t.PinyinStyle.TONE)=>Array.isArray(e)?e.map(e=>i(e,n)):i(e,n),Object.defineProperty(t,"__esModule",{value:!0})});
